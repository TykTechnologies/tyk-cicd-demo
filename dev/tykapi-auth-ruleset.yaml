rules:
  check-authentication-methods:
    description: "At least one of 'enable_jwt' or 'use_mutual_tls_auth' must be true."
    given: "$.api_definition"
    then:
      - field: "enable_jwt"
        function: truthy
        functionOptions:
          negation: true # Should not be false
      - field: "use_mutual_tls_auth"
        function: truthy
        functionOptions:
          negation: true # Should not be false
    severity: error
    message: "At least one of 'api_definition.enable_jwt' or 'api_definition.use_mutual_tls_auth' must be true."