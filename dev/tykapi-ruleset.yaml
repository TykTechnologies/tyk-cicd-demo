extends: 'spectral:oas'

rules:
  no-keyless-auth:
    description: APIs must not be keyless
    given: "$.api_definition"
    severity: error
    then:
      field: use_keyless 
      function: falsy
      
  no-empty-target-url:
    description: JWT auth is not enabled
    given: "$.api_definition"
    severity: warning
    then:
      field: enable_jwt
      function: falsy